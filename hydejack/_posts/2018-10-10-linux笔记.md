--- 
layout: post
title: linux笔记
author: author1
description: >
 个人笔记
---




### linux shell脚本
> 什么是linux shell 脚本???

&emsp;&emsp;答:就是提前写好的命令,用一个简单的命令控制，达到输入一点，执行全部的功能
##### 执行方法: 
```
 ./name.out
```
<br>
### linux下运行后台 v2ray
```
sudo nohup ./v2ray --config v2ray-client.json &
```
//会在文件夹中新建一个日志文件 nohup.txt, 然后删掉此文件也运行

### linux下启动 mariadb(mysql)
```
systemctl start  mariadb.service    //启动 mariadb
```
<br>
cp -l 创建硬连接
			硬连接(无法连接目录)——> 实际上有一个新的文件名指向了inode，就是相互独立的文件的两种叫法。删除文件，连接还在
			
cp -s 创建软连接
			软连接(类似于windows快捷方式)——> 只是文件的别名，如果删除了源文件， 连接也会无法访问

ln -s 创建软连接，不加s为硬连接


cp -a  代所有属性的复制
cp     有些属性没有被复制

\rm -rf 可以去掉alais的参数
-u      用来确定是否需要复制并复制

head -n 选取前n行

od -t   使用何种方式输出二进制文件
<br>
<br>
### linux权限操作
###### 文件目录的隐藏权限与权限管理  
1. 用root用户复制给 普通用户 Joe一个文件
 ```
copy ~/666.cpp  	~/Joe/666.cpp 
 ``` 

2. 必须改变所有者
```
chown Joe           ~/666.cpp
chown Joe:people    ~/666.cpp
```
<br>
###### chattr 给文件赋隐藏权限 
1. umask 文件默认权限  
```
-i 删除前询问  -a 只可添不可删除
```
2. s权限  SUID权限, 二进制程序运行时普通用户获得的临时root权限(对于目录无效)
3. s权限  SGID权限, 二进制程序运行时普通用户获得的临时root权限(对于目录有效)

### 查找命令
```
1. file  [文件名] 查看文件类型
2. which 脚本文件名查询(实际为查找PATH, 不同用户查找的不一样)
3. whereis  替代find，find太慢
4. updatedb 更新数据库
5. locate 查找本地命令
6. find -exex ls -l find执行后再执行ls命令
```  
<br>
## 关于Linux 文件系统的理解
> 读取——> 进入相应的super block ——> 进入super block读取inode的总量,剩余量等等 ——> 由inode记载的相应信息到相应的block读取文件

<br>
_**linux新加磁盘步骤:**_

		1. 给未分配的磁盘 分区                fdisk /dev/sda
		2. 格式化新分配的分区,以创建文件系统    mkfs
		3. 检验                            fsck
		4. 挂载新添加的分区                  mout

linux打包与压缩


## Linus系统备份
以 fedora28 为例子, 首先要插入**容量充足**u盘并格式化为相应的文件系统, 再使用 mount 命令查看你所挂载 U 盘的位置, 
```
mount
```
<br>
使用 rsync 来备份 linux 系统时最佳选择, 有些分区是不能备份的.
eg:
```
sudo time rsync -Pa / /media/youxia/usb/backup_20181009 --exclude=/media/* --exclude=/sys/* --exclude=/proc/* --exclude=/dev/* --exclude=/run/* --exclude=/boot/*  --exclude=/etc/fstab
```
<br>
```
 分析: --exclude=/boot/*     不备份boot, 是因为不同机器的 boot 不同, 备份可能会出现问题
	  --exclude=/etc/fstab   记录系统挂载信息
	  --exclude=/media/*     这里是你 U 盘挂载的地方， 你总不能自己备份自己吧.
	  --exclude=/sys/*
	  --exclude=/proc/* 
	  --exclude=/dev/*
	  --exclude=/run/*
	  --exclude=/tmp/*
```



<br>
那么在 恢复 的时候，只需要 给linux系统分区 ——> 安装最简的 fedora 系统 ——> 执行以下命令
```
sudo time rsync -Pa /media/youxia/usb/backup_20181009/ /
```

打开U盘中的 live系统
ufdisk 查找
挂载本机硬盘到U盘


利用U盘系统，挂载硬盘出现：mount: unknown filesystem type 'LVM2_member'

解决办法：

需要安装 lvm2:  yum install lvm2





然后备份盘与 新机器u盘早已经
    





